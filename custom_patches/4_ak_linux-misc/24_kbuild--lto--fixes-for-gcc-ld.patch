From 84ba8be2515c85d368250aac8c41cf7ebb71d066 Mon Sep 17 00:00:00 2001
From: Andi Kleen <ak@linux.intel.com>
Date: Sat, 27 Jun 2020 20:48:38 -0700
Subject: Kbuild, lto: Fixes for gcc-ld

- Add some missing linker and gcc command line arguments
- When V=1 is specified print the final gcc command line

Signed-off-by: Andi Kleen <ak@linux.intel.com>
---
 scripts/gcc-ld | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/scripts/gcc-ld b/scripts/gcc-ld
index 997b818c39626..cf4907b1b357b 100755
--- a/scripts/gcc-ld
+++ b/scripts/gcc-ld
@@ -8,11 +8,12 @@ ARGS="-nostdlib"
 
 while [ "$1" != "" ] ; do
 	case "$1" in
-	-save-temps|-m32|-m64) N="$1" ;;
+	-save-temps*|-m32|-m64) N="$1" ;;
 	-r) N="$1" ;;
+	-flinker-output*) N="$1" ;;
 	-[Wg]*) N="$1" ;;
 	-[olv]|-[Ofd]*|-nostdlib) N="$1" ;;
-	--end-group|--start-group)
+	--end-group|--start-group|--whole-archive|--no-whole-archive)
 		 N="-Wl,$1" ;;
 	-[RTFGhIezcbyYu]*|\
 --script|--defsym|-init|-Map|--oformat|-rpath|\
@@ -27,4 +28,6 @@ while [ "$1" != "" ] ; do
 	shift
 done
 
+[ -n "$V" ] && echo >&2 $CC $ARGS
+
 exec $CC $ARGS
-- 
cgit 1.2.3-1.el7

